<html>
<head>
	
	<!-- hexo-inject:begin --><!-- hexo-inject:end --><title>MyBatis</title>
	<meta name="keywords" content="代码人生,程序员,赵坤" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
    <!--<link rel="stylesheet" href="/css/main.css">-->
	<link href="/css/main.css?v=2" rel="stylesheet" type="text/css" />
    <!--<link rel="stylesheet" href="/css/style.css">-->
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2"/><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    

</head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><h2 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h2><p><img src="mybatis-logo.png" alt=""></p>
<h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">SqlSession session = sqlSessionFactory.openSession();</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  BlogMapper mapper = session.getMapper(BlogMapper.class);</div><div class="line">  Blog blog = mapper.selectBlog(<span class="number">101</span>);</div><div class="line">&#125; <span class="keyword">finally</span> &#123;</div><div class="line">  session.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p>确保整个应用程序只有<strong>一个 <code>SqlSessionFactory</code> 实例</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">InputStream inputStream = Resources.getResourceAsStream(<span class="string">"mybatis-config.xml"</span>);</div><div class="line">SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</div></pre></td></tr></table></figure>
<p>编写 <strong><code>MyBatis</code> 数据库配置文件</strong> <code>mybatis-config.xml</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE configuration</span></div><div class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></div><div class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.zk.User"</span> <span class="attr">alias</span>=<span class="string">"user"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/crawl"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"UserMapper.xml"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure>
<p>编写 <strong><code>MyBatis</code> - SQL 操作映射文件</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE mapper</span></div><div class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></div><div class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.zk.UserMapper"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUser"</span> <span class="attr">parameterType</span>=<span class="string">"long"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">    select id, name, password from users where id = #&#123;id&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertUser"</span> <span class="attr">parameterType</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">    insert into users(name, password) values (#&#123;name&#125;, #&#123;password&#125;)</div><div class="line">  <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUser"</span> <span class="attr">parameterType</span>=<span class="string">"long"</span>&gt;</span></div><div class="line">    delete from users where id = #&#123;id&#125;;</div><div class="line">  <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure>
<p>执行插入操作:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">InputStream inputStream = Resources.getResourceAsStream(<span class="string">"mybatis-config.xml"</span>);</div><div class="line">SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</div><div class="line"></div><div class="line">SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line"></div><div class="line">User user = <span class="keyword">new</span> User();</div><div class="line">user.setName(<span class="string">"Jack"</span>);</div><div class="line">user.setPassword(<span class="string">"123456"</span>);</div><div class="line"></div><div class="line">userMapper.insertUser(user);</div><div class="line"></div><div class="line">sqlSession.commit();</div><div class="line">sqlSession.close();</div></pre></td></tr></table></figure>
<blockquote>
<p>注: 默认必须调用 <strong><code>sqlSession.commit()</code></strong> 之后才会提交操作</p>
</blockquote>
<h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a><a href="http://www.mybatis.org/mybatis-3/logging.html" target="_blank" rel="external">日志</a></h3><p>MyBatis provides logging information through the use of an internal log factory. The internal log factory will delegate logging information to one of the following log implementations:</p>
<ul>
<li>SLF4J</li>
<li>Apache Commons Logging</li>
<li>Log4j 2</li>
<li>Log4j</li>
<li>JDK logging</li>
</ul>
<p><strong>The logging solution chosen is based on runtime introspection by the internal MyBatis log factory.</strong></p>
<hr>
<p>添加依赖:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<p>放置 <code>log4j.properties</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># Global logging configuration</div><div class="line">log4j.rootLogger=DEBUG,stdout</div><div class="line"># MyBatis logging configuration</div><div class="line">log4j.logger.org.mybatis=DEBUG</div><div class="line"># Console output...</div><div class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</div><div class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.stdout.layout.ConversionPattern=%5p %d %C: %m%n</div></pre></td></tr></table></figure>
<h3 id="传递多个参数-Map"><a href="#传递多个参数-Map" class="headerlink" title="传递多个参数 - Map"></a>传递多个参数 - <code>Map</code></h3><p>将 <code>parameterType</code> 的值设置为 <strong><code>map</code></strong> 即可接受多个参数:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUseWithMapParam"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">  select id, name, password from users where name = #&#123;name&#125; and password = #&#123;password&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</div><div class="line">    <span class="function">User <span class="title">getUseWithMapParam</span><span class="params">(Map&lt;String, String&gt; params)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Map&lt;String, String&gt; params = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">params.put(<span class="string">"name"</span>, <span class="string">"Zhaokun"</span>);</div><div class="line">params.put(<span class="string">"password"</span>, <span class="string">"123456"</span>);</div><div class="line">User user = userMapper.getUseWithMapParam(params);</div></pre></td></tr></table></figure>
<h3 id="插入的时候自动回填主键"><a href="#插入的时候自动回填主键" class="headerlink" title="插入的时候自动回填主键"></a>插入的时候自动回填主键</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertUserWithAutoGenerateId"</span> <span class="attr">parameterType</span>=<span class="string">"user"</span></span></div><div class="line"><span class="tag">        <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span>&gt;</span></div><div class="line">  insert into users(name, password) values (#&#123;name&#125;, #&#123;password&#125;)</div><div class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertUserWithAutoGenerateId</span><span class="params">(User user)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">User user = createUser();</div><div class="line">userMapper.insertUserWithAutoGenerateId(user);</div><div class="line">System.out.println(user.getId());</div></pre></td></tr></table></figure>
<h3 id="传递多个参数-Param"><a href="#传递多个参数-Param" class="headerlink" title="传递多个参数 - @Param"></a>传递多个参数 - <code>@Param</code></h3><p><strong>不用声明 <code>parameterType</code></strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUseWithAnnotationParam"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">  select id, name, password from users where name = #&#123;name&#125; and password = #&#123;password&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</div><div class="line">    <span class="function">User <span class="title">getUseWithAnnotationParam</span><span class="params">(@Param(<span class="string">"name"</span>)</span> String name, @<span class="title">Param</span><span class="params">(<span class="string">"password"</span>)</span> String password)</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="参数设置精度"><a href="#参数设置精度" class="headerlink" title="参数设置精度"></a>参数设置精度</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#&#123;price, javaType=double, jdbcType=NUMERIC, numericScale=2&#125;</div></pre></td></tr></table></figure>
<h3 id="association-一对一级联"><a href="#association-一对一级联" class="headerlink" title="association 一对一级联"></a>association 一对一级联</h3><p><strong>学生拥有学生卡</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> StudentCard studentCard;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentCard</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">long</span> cardId;</div><div class="line">    <span class="keyword">private</span> String cardName;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"studentAndCardMap"</span> <span class="attr">type</span>=<span class="string">"com.zk.Student"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"student.id"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"user_name"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"studentCard"</span> <span class="attr">javaType</span>=<span class="string">"com.zk.StudentCard"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"cardId"</span> <span class="attr">column</span>=<span class="string">"card_id"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"cardName"</span> <span class="attr">column</span>=<span class="string">"card_name"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getStudent"</span> <span class="attr">parameterType</span>=<span class="string">"long"</span> <span class="attr">resultMap</span>=<span class="string">"studentAndCardMap"</span>&gt;</span></div><div class="line">  select student.id as user_id,</div><div class="line">  student.name as user_name,</div><div class="line">  student_card.id as card_id,</div><div class="line">  student_card.name as card_name</div><div class="line">  FROM student left outer join student_card</div><div class="line">  ON student.id = student_card.user_id</div><div class="line">  WHERE student.id = #&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="collection-一对多级联"><a href="#collection-一对多级联" class="headerlink" title="collection 一对多级联"></a>collection 一对多级联</h3><p><strong>学生拥有多门课程</strong>:</p>
<h3 id="If-元素"><a href="#If-元素" class="headerlink" title="If 元素"></a>If 元素</h3><p><strong>某个元素不为 <code>null</code> 且不为空字符串就查询</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;select id=<span class="string">"selectByPrimaryKey"</span> resultMap=<span class="string">"BaseResultMap"</span> parameterType=<span class="string">"java.lang.String"</span> &gt;</div><div class="line">  select user_name, user_password</div><div class="line">  from asec_phishingapp_review_task</div><div class="line">  where <span class="number">1</span> = <span class="number">1</span></div><div class="line">  &lt;<span class="keyword">if</span> test=<span class="string">"userId != null and userId != ''"</span>&gt;</div><div class="line">    <span class="function">and user_id like <span class="title">concat</span><span class="params">(<span class="string">'%'</span>, #&#123;userId&#125;, <span class="string">'%'</span>)</span></span></div><div class="line"><span class="function">  &lt;/<span class="keyword">if</span>&gt;</span></div><div class="line"><span class="function">&lt;/select&gt;</span></div></pre></td></tr></table></figure>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><h4 id="1-分清-和-的区别"><a href="#1-分清-和-的区别" class="headerlink" title="(1) 分清 # 和 $ 的区别"></a>(1) <a href="https://segmentfault.com/a/1190000004617028" target="_blank" rel="external">分清 <code>#</code> 和 <code>$</code> 的区别</a></h4><p><strong>不要误把 <code>#</code> 写成了 <code>$</code></strong>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;select id=&quot;selectBy&quot; resultMap=&quot;BaseResultMap&quot;&gt;</div><div class="line">  select &lt;include refid=&quot;Base_Column_List&quot; /&gt;</div><div class="line">  from asec_phishingapp_review_task</div><div class="line">  where package_name = $&#123;packageName&#125; AND cer_hash = $&#123;cerHash&#125;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
<p>对于同样的一句 SQL 语句，如:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">name</span> = #&#123;<span class="keyword">name</span>&#125;;</div></pre></td></tr></table></figure>
<ul>
<li><code>#{name}</code> 解析为一个 JDBC 预编译语句（prepared statement）的<strong>参数标记符 <code>?</code></strong>:</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">name</span> = ?;</div></pre></td></tr></table></figure>
<ul>
<li><code>${name}</code> 仅仅为一个<strong>纯碎的 string 替换</strong>，在动态 SQL 解析阶段将会进行变量替换:</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">"Tom"</span>;</div></pre></td></tr></table></figure>
<h4 id="2-分清-resultMap-和-resultType"><a href="#2-分清-resultMap-和-resultType" class="headerlink" title="(2) 分清 resultMap 和 resultType:"></a>(2) 分清 <code>resultMap</code> 和 <code>resultType</code>:</h4><p>这两个不能同时存在</p>
<ul>
<li><strong><code>resultMap</code> 自定义映射关系</strong>来将表的列名转换为类的字段:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.zk.User&quot; &gt;</div><div class="line">  &lt;result column=&quot;user_name&quot; property=&quot;userName&quot; jdbcType=&quot;VARCHAR&quot; /&gt;</div><div class="line">  &lt;result column=&quot;user_password&quot; property=&quot;userPassword&quot; jdbcType=&quot;VARCHAR&quot; /&gt;</div><div class="line">&lt;/resultMap&gt;</div><div class="line"></div><div class="line">&lt;sql id=&quot;Base_Column_List&quot; &gt;</div><div class="line">  user_name, user_password</div><div class="line">&lt;/sql&gt;</div><div class="line"></div><div class="line">&lt;select id=&quot;selectBy&quot; resultMap=&quot;BaseResultMap&quot;&gt;</div><div class="line">  select &lt;include refid=&quot;Base_Column_List&quot; /&gt;</div><div class="line">  from users</div><div class="line">  where user_name = #&#123;userName&#125; AND user_password = #&#123;userPassword&#125;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
<ul>
<li><strong><code>resultType</code> 需要通过 AS 来将表的列名映射为类的字段</strong>:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;sql id=&quot;Base_Column_List&quot; &gt;</div><div class="line">  user_name AS userName, user_password AS userPassword</div><div class="line">&lt;/sql&gt;</div><div class="line"></div><div class="line">&lt;select id=&quot;selectBy&quot; resultType=&quot;com.zk.User&quot;&gt;</div><div class="line">  select &lt;include refid=&quot;Base_Column_List&quot; /&gt;</div><div class="line">  from users</div><div class="line">  where userName = #&#123;userName&#125; AND userPassword = #&#123;userPassword&#125;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
<p>如果<strong>不加 <code>AS</code> 的话，那么就会直接将表的列名映射为类的字段</strong>。</p>
<h3 id="批量更新"><a href="#批量更新" class="headerlink" title="批量更新"></a>批量更新</h3><p>在数据库中使用批量更新有助于提高性能:</p>
<p><strong>1) 配置批量更新</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">settings</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"defaultExecutorType"</span> <span class="attr">value</span>=<span class="string">"BATCH"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>2) <code>Java</code> 代码开启</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sqlSessionFactory.openSession(ExecutorType.BATCH);</div></pre></td></tr></table></figure>
<h3 id="MyBatis-Generator"><a href="#MyBatis-Generator" class="headerlink" title="MyBatis Generator"></a>MyBatis Generator</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mvn mybatis-generator:generate</div></pre></td></tr></table></figure>
<p><a href="http://www.mybatis.org/generator/running/runningWithMaven.html" target="_blank" rel="external">一篇教程足以</a></p>
<h4 id="1-如何防止覆盖已经生成的文件"><a href="#1-如何防止覆盖已经生成的文件" class="headerlink" title="(1) 如何防止覆盖已经生成的文件:"></a>(1) 如何防止覆盖已经生成的文件:</h4><p>注意这个是要<strong>放到 <code>pom.xml</code> 文件</strong>中的，不是 <code>generatorConfig.xml</code> 文件中:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">mybatis.generator.overwrite</span>&gt;</span>false<span class="tag">&lt;/<span class="name">mybatis.generator.overwrite</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="2-在源码编译之前生成-Java-接口和-XML-文件"><a href="#2-在源码编译之前生成-Java-接口和-XML-文件" class="headerlink" title="(2) 在源码编译之前生成 Java 接口和 XML 文件:"></a>(2) 在源码编译之前生成 <code>Java</code> 接口和 <code>XML</code> 文件:</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">executions</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>Generate MyBatis Artifacts<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">goals</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>generate<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="3-添加mysql-connector-依赖"><a href="#3-添加mysql-connector-依赖" class="headerlink" title="(3) 添加mysql-connector 依赖:"></a>(3) 添加<code>mysql-connector</code> 依赖:</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">executions</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>Generate MyBatis Artifacts<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">goals</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>generate<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.43<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="4-指定配置文件参数"><a href="#4-指定配置文件参数" class="headerlink" title="(4) 指定配置文件参数:"></a>(4) 指定配置文件参数:</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></div><div class="line">  # 这个就是默认路径</div><div class="line">  <span class="tag">&lt;<span class="name">mybatis.generator.configurationFile</span>&gt;</span>$&#123;basedir&#125;/src/main/resources/generatorConfig.xml<span class="tag">&lt;/<span class="name">mybatis.generator.configurationFile</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>只需要在 <code>properties</code> 里加上这句话</strong>就可以了，插件运行的时候，能够自动找到这句话，进行相应的配置。</p>
<h4 id="5-配置文件参数详解"><a href="#5-配置文件参数详解" class="headerlink" title="(5) 配置文件参数详解:"></a>(5) 配置文件参数详解:</h4><p><a href="http://www.mybatis.org/generator/configreference/xmlconfig.html" target="_blank" rel="external">MyBatis GeneratorXML Configuration File Reference</a></p>
<hr>
<p><strong>5.1 怎样连接数据库</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"database.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"Mysql"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"$&#123;driver&#125;"</span></span></div><div class="line"><span class="tag">      <span class="attr">connectionURL</span>=<span class="string">"$&#123;url&#125;"</span></span></div><div class="line"><span class="tag">      <span class="attr">userId</span>=<span class="string">"$&#123;username&#125;"</span></span></div><div class="line"><span class="tag">      <span class="attr">password</span>=<span class="string">"$&#123;password&#125;"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">context</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></div></pre></td></tr></table></figure>
<p>下面是 <strong><code>database.properties</code></strong> 的一个示例 (对应的是 <code>mysql-connector-5.x</code> 版本):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">driver=com.mysql.jdbc.Driver</div><div class="line">url=jdbc:mysql://localhost:3306/test_db</div><div class="line">username=root</div><div class="line">password=root</div></pre></td></tr></table></figure>
<ul>
<li><strong>id</strong>: 这个 <code>Context</code> 的唯一的标识符</li>
</ul>
<p>关于 <code>Context</code> 的<a href="http://www.mybatis.org/generator/configreference/context.html" target="_blank" rel="external">进一步解释</a></p>
<hr>
<p><strong>5.2 javaTypeResolver</strong></p>
<p><strong><code>javaTypeResolver</code></strong> 用来计算从<strong>数据库列如何转变为 <code>Java</code> 类型</strong>，<code>forceBigDecimals</code> 的默认值就是 <code>false</code>，即<strong>默认情况下数据库的 <code>DECIMAL</code> 和 <code>NUMERIC</code> 这两种数据库类型会转变为 <code>Java</code> 的 <code>Long</code>, <code>Integer</code>, <code>Short</code>, 等相应类型</strong>。如果这不是你想要的效果，那么请改为 <code>true</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"Mysql"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">context</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></div></pre></td></tr></table></figure>
<hr>
<p><strong>5.3 javaModelGenerator</strong>:</p>
<p>用来<strong>定义 <code>Java</code> 模型生成器的属性，即生成一些 <code>JavaBean</code> 类</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.buptnsrc.appcrawl.entity"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li><code>targetPackage</code>: 生成的<strong> <code>JavaBean</code> 类放在哪个包下面，<code>MyBatis</code> 会自动创建包</strong></li>
<li><code>targetProject</code>: 指定<strong>从项目根路径到包顶级的路径，<code>MyBatis</code> 不会自动创建文件夹</strong></li>
<li><code>enableSubPackages</code>: 如果 <code>true</code>，<code>MBG</code> 会根据 <code>catalog</code> 和 <code>schema</code> 来生成子包。如果 <code>false</code> 就会直接用 <code>targetPackage</code> 属性。默认为 <code>false</code></li>
<li><code>trimStrings</code>: 是否对数据库查询结果进行 <code>trim</code> 操作，如果设置为 <code>true</code> 就会生成类似这样:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.username = username == <span class="keyword">null</span> ? <span class="keyword">null</span> : username.trim();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>的 <code>setter</code> 方法。默认值为 <code>false</code></p>
<hr>
<p><strong>5.4 sqlMapGenerator</strong></p>
<p>生成 <code>Mapper.xml</code> 文件:</p>
<p><img src="2017_08_30_22_58_05.png" alt=""></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.zk.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></div></pre></td></tr></table></figure>
<hr>
<p><strong>5.5 javaClientGenerator</strong></p>
<p>生成 <code>Mapper.java</code> 文件:</p>
<p><img src="2017_08_30_22_59_56.png" alt=""></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.zk.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span></span></div><div class="line"><span class="tag">                     <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></div></pre></td></tr></table></figure>
<hr>
<p><strong>5.6 table</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"model_monitor"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useActualColumnNames"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li><code>useActualColumnNames</code>: If <strong>true</strong>, then MBG will use <strong>列名</strong> as returned from the database metadata as the properties of the generated domain objects. If <code>false</code> (<strong>默认 <code>false</code></strong>), MBG will attempt to <strong>驼峰</strong> the returned names. In either event, the name can be specified <strong>明确地</strong> by the <code>&lt;columnOverride&gt;</code> element in which case this property will be ignored for the specified column. For example, suppose a table contains a <strong>列 <code>START_DATE</code></strong> . If the value of this property is “true”, then MBG will generate the property name as <code>START_DATE</code> - meaning that the getters and setters for the value will be <code>getSTART_DATE()</code> and <code>setSTART_DATE()</code>. If the value of this property is <strong>false</strong>, then MBG will generate the <strong>属性名</strong> as <strong><code>startDate</code></strong> - meaning that the getters and setters for the value will be <code>getStartDate()</code> and <code>setStartDate()</code>.</li>
</ul>
<h4 id="6-元素定义顺序问题"><a href="#6-元素定义顺序问题" class="headerlink" title="(6) 元素定义顺序问题"></a>(6) 元素定义顺序问题</h4><p><code>generatorConfig.xml</code> 中 <code>&lt;context&gt;</code> 下面的子元素的顺序可不是任意的，这点很让人疑惑，它必须遵从一定的顺序，而不是像常见的那样任意顺序均可:</p>
<p><img src="2017_08_30_22_46_36.png" alt=""></p>
<p>如果顺序有误，会提示:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[ERROR] Failed to execute goal org.mybatis.generator:mybatis-generator</div><div class="line">-maven-plugin:1.3.5:generate (default-cli) on project mybatis: XML Parser</div><div class="line">Error on line 35: The content of element type &quot;context&quot; must match </div><div class="line">&quot;(property*,plugin*,commentGenerator?,(connectionFactory|jdbcConnection),</div><div class="line">javaTypeResolver?,javaModelGenerator,sqlMapGenerator?,javaClientGenerator?,</div><div class="line">table+)&quot;. -&gt; [Help 1]</div></pre></td></tr></table></figure>
<ul>
<li>参考: <a href="https://stackoverflow.com/questions/37019672/mybatis-generators-bug-configuration-items-should-be-ordered" target="_blank" rel="external">Mybatis Generator’s bug: configuration items should be ordered?</a></li>
</ul>
<p>网友的回答中最后也指出: Maybe you want to know how to make the element out of order, question <a href="https://stackoverflow.com/questions/5643738/how-to-define-dtd-without-strict-element-order" target="_blank" rel="external">How to define DTD without strict element order</a> could be useful.</p>
<h4 id="7-Cannot-obtain-primary-key-information-from-the-database-generated-objects-may-be-incomplete"><a href="#7-Cannot-obtain-primary-key-information-from-the-database-generated-objects-may-be-incomplete" class="headerlink" title="(7) Cannot obtain primary key information from the database, generated objects may be incomplete"></a>(7) Cannot obtain primary key information from the database, generated objects may be incomplete</h4><p>使用 <code>mysql-connector-6.0.6</code> 和 <code>mybatis-generator-core-1.3.5</code> 这两个相结合，在编译完成之后所生成的 <code>Mapper</code> 中，只有两个方法:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(Student record)</span></span>;</div><div class="line">    <span class="function">List&lt;Student&gt; <span class="title">selectAll</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>为什么只有两个方法，为什么缺失了其它一些常见的方法，用过 <code>MyBatis Generator</code> 的同学，肯定知道它不止自动生成这两个方法。再查看 <code>mvn compile</code> 的 <code>Console</code> 信息来看，发现有一条 <code>Warning</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[WARNING] Cannot obtain primary key information from the database, generated objects may be incomplete</div></pre></td></tr></table></figure>
<p>带着这句话来 <code>Google</code> 搜索，相关网站聊聊无几，但是却找到了这句话的源文件:</p>
<p><img src="2017_08_31_16_30_39.png" alt=""></p>
<p>于是将 <a href="https://github.com/mybatis/generator" target="_blank" rel="external"><code>mybatis-generator</code></a> 整个项目 <code>clone</code> 到本地，想调试一下看究竟哪里出现了问题。</p>
<p>如下图所示，原来在调用 <code>databaseMetaData.getPrimaryKeys</code> 的时候，<a href="https://github.com/mybatis/generator/blob/mybatis-generator-1.3.5/core/mybatis-generator-core/src/main/java/org/mybatis/generator/internal/db/DatabaseIntrospector.java#L113,L122" target="_blank" rel="external">源代码</a>只是简单的给出了警告信息 <code>warnings.add(getString(&quot;Warning.15&quot;))</code> ，但是异常信息我们却没有任何方式知道，因此修改源代码添加了 <strong><code>warnings.add(e.toString())</code></strong> 这句代码以便打印出异常信息:</p>
<p><img src="2017_08_31_16_35_39.png" alt=""></p>
<p>接着使用 <strong><code>mvn package</code></strong> 重新打包生成 <code>mybatis-generator-core-1.3.6-SNAPSHOT.jar</code>。因为生成 <code>Mapper</code> 的过程需要用到 <code>mysql-connector.jar</code> ，因此也需要拷贝 <code>mysql-connector-java-6.0.6.jar</code> 过来，才能在命令行运行程序:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -cp mybatis-generator-core-<span class="number">1.3</span>.6-SNAPSHOT.jar:mysql-connector-java-<span class="number">6.0</span>.6.jar org.mybatis.generator.api.ShellRunner -configfile generatorConfig.xml -overwrite</div></pre></td></tr></table></figure>
<p>随后我们在刚才的 <code>Warning</code> 下面看到了这个异常信息:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java.sql.SQLSyntaxErrorException: Unknown table &apos;student&apos; in information_schema</div></pre></td></tr></table></figure>
<p>结合源代码，我们知道原来是在调用方法 <code>databaseMetaData.getPrimaryKeys</code> 这句话的时候引发了 <code>SQL</code> 语句错误，导致出现异常并给出了如下警告信息。但为什么会出现语句错误问题呢？</p>
<p><code>java.sql.DatabaseMetaData</code> 只是一个接口，这句话的实现类是由各个数据库厂商实现的，那么此时我们应该在 <code>mysql-connector</code> 中寻找究竟是哪个类实现了这个接口，使用如下命令重新尝试运行程序:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -verbose:class -cp mybatis-generator-core-1.3.6-SNAPSHOT.jar:mysql-connector-java-6.0.6.jar org.mybatis.generator.api.ShellRunner -configfile generatorConfig.xml -overwrite | grep MetaData</div></pre></td></tr></table></figure>
<p>上述命令帮助我们找到了真正的 <code>DatabaseMetaData</code> 的实现类 <code>com.mysql.cj.jdbc.DatabaseMetaData</code>:</p>
<p><img src="2017_08_31_16_55_24.png" alt=""></p>
<p>接下来我们需要调试 <code>mysql-connector</code> 的实现了，具体需要:</p>
<ul>
<li>克隆 <a href="https://github.com/mysql/mysql-connector-j/tree/6.0.6" target="_blank" rel="external">mysql-connector 6.6 版本</a> 的源代码到本地</li>
<li>克隆到本地后，<a href="https://dev.mysql.com/doc/connector-j/5.1/en/connector-j-installing-source.html" target="_blank" rel="external">参考官网指示</a>，在代码根目录创建一个文件 <code>build.properties</code>,告诉 <code>mysql</code> 的 <code>JVM</code> 的路径所在:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">com.mysql.cj.build.jdk=/usr/lib/jvm/oracle_jdk8/jdk1.8.0_144</div></pre></td></tr></table></figure>
<ul>
<li>修改 <code>build.xml</code> 文件中的 <code>javassist</code> 库的版本信息，提升一下版本 (需要下载 <a href="https://mvnrepository.com/artifact/org.javassist/javassist/3.18.2-GA" target="_blank" rel="external"><code>javassist.jar</code></a> 并将其放到 <code>lib</code> 文件夹下面):</li>
</ul>
<p><img src="2017_08_31_17_03_11.png" alt=""></p>
<p>如果不修改直接使用版本 <code>3.15.0</code> 编译的话，会报如下错误:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">[java] Exception in thread <span class="string">"main"</span> java.lang.RuntimeException: java.io.IOException: invalid constant type: <span class="number">18</span></div><div class="line">[java] 	at javassist.CtClassType.getClassFile2(CtClassType.java:<span class="number">204</span>)</div><div class="line">[java] 	at javassist.CtClassType.makeFieldCache(CtClassType.java:<span class="number">835</span>)</div><div class="line">[java] 	at javassist.CtClassType.getMembers(CtClassType.java:<span class="number">826</span>)</div><div class="line">[java] 	at javassist.CtClassType.getDeclaredMethod(CtClassType.java:<span class="number">1205</span>)</div><div class="line">[java] 	at instrumentation.CommonChecks.main(CommonChecks.java:<span class="number">68</span>)</div><div class="line">[java] Caused by: java.io.IOException: invalid constant type: <span class="number">18</span></div><div class="line">[java] 	at javassist.bytecode.ConstPool.readOne(ConstPool.java:<span class="number">1113</span>)</div><div class="line">[java] 	at javassist.bytecode.ConstPool.read(ConstPool.java:<span class="number">1056</span>)</div><div class="line">[java] 	at javassist.bytecode.ConstPool.&lt;init&gt;(ConstPool.java:<span class="number">150</span>)</div><div class="line">[java] 	at javassist.bytecode.ClassFile.read(ClassFile.java:<span class="number">765</span>)</div><div class="line">[java] 	at javassist.bytecode.ClassFile.&lt;init&gt;(ClassFile.java:<span class="number">109</span>)</div><div class="line">[java] 	at javassist.CtClassType.getClassFile2(CtClassType.java:<span class="number">191</span>)</div><div class="line">[java] 	... <span class="number">4</span> more</div></pre></td></tr></table></figure>
<p>参考网友的<a href="https://stackoverflow.com/questions/30313255/reflections-java-8-invalid-constant-type" target="_blank" rel="external">回答</a>，这说明这个库中的 <code>Java Parser</code> 还识别不了 <code>Java 8</code> 中的 <code>constant type</code>，所以推荐换用版本更高的 <code>javassist</code>。</p>
<ul>
<li>修改源代码中的 <a href="https://github.com/mysql/mysql-connector-j/blob/6.0.6/src/main/java/com/mysql/cj/jdbc/DatabaseMetaData.java#L3177,L3182" target="_blank" rel="external"><code>DatabaseMetaData.java</code></a> 文件，找到方法 <code>getPrimaryKeys</code> 的实现，添加一行打印信息:</li>
</ul>
<p><img src="2017_08_31_17_17_06.png" alt=""></p>
<ul>
<li>使用 <strong><code>ant dist</code></strong> 进行编译</li>
</ul>
<p>重新运行命令，尝试生成 <code>Mapper</code>，于是我们会得到如下所示的一条 <code>SQL</code> 语句:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SHOW</span> <span class="keyword">KEYS</span> <span class="keyword">FROM</span> <span class="string">`student`</span> <span class="keyword">FROM</span> <span class="string">`information_schema`</span></div></pre></td></tr></table></figure>
<p>就是在执行这条 <code>SQL</code> 语句的时候，发生了语法错误。通过从 <code>mysql-connector-6.0.6</code> 降到 <code>5.x</code> 版本能够解决这个问题，相应地打印出的 <code>SQL</code> 语句就变成了:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SHOW</span> <span class="keyword">KEYS</span> <span class="keyword">FROM</span> <span class="string">`student`</span> <span class="keyword">FROM</span> <span class="string">`test_db`</span></div></pre></td></tr></table></figure>
<h4 id="8-系统缓存问题"><a href="#8-系统缓存问题" class="headerlink" title="(8) 系统缓存问题"></a>(8) 系统缓存问题</h4><p>没有配置的<strong>默认情况下，<code>MyBatis</code> 只开启一级缓存</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">SqlSession session = sqlSessionFactory.openSession();</div><div class="line">StudentMapper studentMapper = session.getMapper(StudentMapper.class);</div><div class="line">studentMapper.getStudent(<span class="number">1</span>);</div><div class="line">studentMapper.getStudent(<span class="number">1</span>);</div></pre></td></tr></table></figure>
<p>我们在同一个 <code>session</code> 上调用了两次查询，而<strong>第二次查询是从缓存中查出</strong>的。</p>
<h4 id="9-原理简介"><a href="#9-原理简介" class="headerlink" title="(9) 原理简介"></a>(9) 原理简介</h4><p><code>StudentMapper</code> 接口运行时究竟是什么类型:</p>
<p><img src="2017_08_31_21_56_55.png" alt=""></p>
<p>而且，它就是在运行时采用的 <strong><code>JDK</code> 的动态代理</strong>技术实现的:</p>
<p><img src="2017_08_31_22_03_30.png" alt=""></p>
<h4 id="10-完整版-generatorConfig-xml-和-mybatis-config-xml-示例"><a href="#10-完整版-generatorConfig-xml-和-mybatis-config-xml-示例" class="headerlink" title="(10) 完整版 generatorConfig.xml 和 mybatis-config.xml 示例"></a>(10) 完整版 <code>generatorConfig.xml</code> 和 <code>mybatis-config.xml</code> 示例</h4><p><strong>1) <code>generatorConfig.xml</code> 文件</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></div><div class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></div><div class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"database.properties"</span> &gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"Mysql"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"$&#123;driver&#125;"</span></span></div><div class="line"><span class="tag">                    <span class="attr">connectionURL</span>=<span class="string">"$&#123;url&#125;"</span></span></div><div class="line"><span class="tag">                    <span class="attr">userId</span>=<span class="string">"$&#123;username&#125;"</span></span></div><div class="line"><span class="tag">                    <span class="attr">password</span>=<span class="string">"$&#123;password&#125;"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.zk"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.zk.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.zk.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span></span></div><div class="line"><span class="tag">                         <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"student"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useActualColumnNames"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"tasks"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"useActualColumnNames"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">context</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>2 <code>mybatis-config.xml</code> 文件</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE configuration</span></div><div class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></div><div class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"database.properties"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.zk.Student"</span> <span class="attr">alias</span>=<span class="string">"student"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;driver&#125;"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;url&#125;"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;username&#125;"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;password&#125;"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/zk/mapper/StudentMapper.xml"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure><!-- hexo-inject:begin --><!-- hexo-inject:end -->






</body>
</html>
