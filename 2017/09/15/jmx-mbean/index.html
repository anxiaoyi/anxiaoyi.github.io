<html>
<head>
	
	<!-- hexo-inject:begin --><!-- hexo-inject:end --><title>jmx-mbean</title>
	<meta name="keywords" content="代码人生,程序员,赵坤" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
    <!--<link rel="stylesheet" href="/css/main.css">-->
	<link href="/css/main.css?v=2" rel="stylesheet" type="text/css" />
    <!--<link rel="stylesheet" href="/css/style.css">-->
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2"/><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    

</head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><h2 id="JMX"><a href="#JMX" class="headerlink" title="JMX"></a>JMX</h2><h3 id="无法连接到指定应用程序"><a href="#无法连接到指定应用程序" class="headerlink" title="无法连接到指定应用程序"></a>无法连接到指定应用程序</h3><p><img src="2017_09_15_10_32_12.png" alt=""></p>
<blockquote>
<p>注意: 3867 是进程 ID</p>
</blockquote>
<p>运行程序的时候使用如下命令:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">-Dcom.sun.management.jmxremote.port=<span class="number">9005</span></div><div class="line">-Dcom.sun.management.jmxremote.authenticate=<span class="keyword">false</span></div><div class="line">-Dcom.sun.management.jmxremote.ssl=<span class="keyword">false</span></div></pre></td></tr></table></figure>
<h3 id="查看-MBeans-相关属性信息"><a href="#查看-MBeans-相关属性信息" class="headerlink" title="查看 MBeans 相关属性信息"></a>查看 <code>MBeans</code> 相关属性信息</h3><p><img src="2017_09_15_10_42_28.png" alt=""></p>
<h3 id="jinfo"><a href="#jinfo" class="headerlink" title="jinfo"></a><code>jinfo</code></h3><p>使用 <code>root</code> 权限运行就好了:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">zk@zk-pc:~/Documents$ jinfo 11279</div><div class="line">Attaching to process ID 11279, please <span class="built_in">wait</span>...</div><div class="line">Error attaching to process: sun.jvm.hotspot.debugger.DebuggerException: Can<span class="string">'t attach to the process: ptrace(PTRACE_ATTACH, ..) failed for 11279: Operation not permitted</span></div><div class="line"><span class="string">sun.jvm.hotspot.debugger.DebuggerException: sun.jvm.hotspot.debugger.DebuggerException: Can'</span>t attach to the process: ptrace(PTRACE_ATTACH, ..) failed <span class="keyword">for</span> 11279: Operation not permitted</div><div class="line">	at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal<span class="variable">$LinuxDebuggerLocalWorkerThread</span>.execute(LinuxDebuggerLocal.java:163)</div><div class="line">	at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal.attach(LinuxDebuggerLocal.java:278)</div><div class="line">	at sun.jvm.hotspot.HotSpotAgent.attachDebugger(HotSpotAgent.java:671)</div><div class="line">	at sun.jvm.hotspot.HotSpotAgent.setupDebuggerLinux(HotSpotAgent.java:611)</div><div class="line">	at sun.jvm.hotspot.HotSpotAgent.setupDebugger(HotSpotAgent.java:337)</div><div class="line">	at sun.jvm.hotspot.HotSpotAgent.go(HotSpotAgent.java:304)</div><div class="line">	at sun.jvm.hotspot.HotSpotAgent.attach(HotSpotAgent.java:140)</div><div class="line">	at sun.jvm.hotspot.tools.Tool.start(Tool.java:185)</div><div class="line">	at sun.jvm.hotspot.tools.Tool.execute(Tool.java:118)</div><div class="line">	at sun.jvm.hotspot.tools.JInfo.main(JInfo.java:138)</div><div class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</div><div class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</div><div class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</div><div class="line">	at java.lang.reflect.Method.invoke(Method.java:498)</div><div class="line">	at sun.tools.jinfo.JInfo.runTool(JInfo.java:108)</div><div class="line">	at sun.tools.jinfo.JInfo.main(JInfo.java:76)</div><div class="line">Caused by: sun.jvm.hotspot.debugger.DebuggerException: Can<span class="string">'t attach to the process: ptrace(PTRACE_ATTACH, ..) failed for 11279: Operation not permitted</span></div><div class="line"><span class="string">	at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal.attach0(Native Method)</span></div><div class="line"><span class="string">	at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal.access$100(LinuxDebuggerLocal.java:62)</span></div><div class="line"><span class="string">	at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal$1AttachTask.doit(LinuxDebuggerLocal.java:269)</span></div><div class="line"><span class="string">	at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal$LinuxDebuggerLocalWorkerThread.run(LinuxDebuggerLocal.java:138)</span></div></pre></td></tr></table></figure>
<h3 id="CPU-占用率过高"><a href="#CPU-占用率过高" class="headerlink" title="CPU 占用率过高"></a>CPU 占用率过高</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$ top</div><div class="line"> PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                        </div><div class="line">12136 zk        20   0 4742404 100368  18432 S  99.7  1.7  20:43.61 java </div><div class="line"></div><div class="line">$ strace -t -p 46322</div><div class="line">12:30:16 sched_yield()                  = 0</div><div class="line">12:30:16 sched_yield()                  = 0</div><div class="line">12:30:16 sched_yield()                  = 0</div><div class="line">12:30:16 sched_yield()                  = 0</div><div class="line">12:30:16 sched_yield()                  = 0</div><div class="line">12:30:16 sched_yield()                  = 0</div><div class="line">12:30:16 sched_yield()                  = 0</div></pre></td></tr></table></figure>
<h3 id="某种命令暂时无法运行-响应的"><a href="#某种命令暂时无法运行-响应的" class="headerlink" title="某种命令暂时无法运行/响应的"></a>某种命令暂时无法运行/响应的</h3><p>加上 <strong>-F</strong> 参数即可解决</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ jstack 12136</div><div class="line">12136: Unable to open socket file: target process not responding or HotSpot VM not loaded</div><div class="line">The -F option can be used when the target process is not responding</div><div class="line"><span class="comment"># /usr/lib/jvm/oracle_jdk8/jdk1.8.0_144/bin/jstack -F 12136</span></div><div class="line">$ sudo -u root /usr/lib/jvm/oracle_jdk8/jdk1.8.0_144/bin/jstack -F 12136</div></pre></td></tr></table></figure><!-- hexo-inject:begin --><!-- hexo-inject:end -->






</body>
</html>
