<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="链表"><meta property="og:title" content="链表" />
<meta property="og:description" content="链表 反转链表 头条：迭代、递归都要写出来。
迭代版本：
public ListNode reverseList(ListNode head) { ListNode newHead = new ListNode(); while (head != null) { // 5 -&gt; 4 -&gt; 3  //  ListNode tmp = head.next; head.next = newHead.next; newHead.next = head; head = tmp; } return newHead.next; } 递归版本。
 将链表想象为：head -&gt; 其余部分，那么翻转 其余部分 如何翻转：p = reverseList(head.next)。其余部分 的 next 的节点需要指向 head，head 的 next 节点需要置为 null，以确保 head 变成了末尾节点。最后返回 p 节点。
  在写的时候，有一次写成了 p.next = head，这里是不正确的。head." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kunzhao.org/docs/tutorial/algorithm/linkedlist/" /><meta property="article:section" content="docs" />



<title>链表 | 赵坤的个人网站</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/book.min.827556f4a4b428e6ff4e68c72777003c28afbb68322bd35664dd0889a941daa0.css" integrity="sha256-gnVW9KS0KOb/TmjHJ3cAPCivu2gyK9NWZN0IialB2qA=">


<script defer src="/en.search.min.d855943406294b3828037a1ac91f970000e2df3fe538f710d7050da0ed846095.js" integrity="sha256-2FWUNAYpSzgoA3oayR&#43;XAADi3z/lOPcQ1wUNoO2EYJU="></script>
<script>
var _hmt = _hmt || [];
(function() {
  if (location.hostname === "localhost" || 
    location.hostname === "127.0.0.1") {
    return;
  }

  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d04ff9e23cec6cb39ebbee1b4883e269";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<script data-ad-client="ca-pub-8950855178079071" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><span>赵坤的个人网站</span>
  </a>
</h2>








  

  
  





 
  
    




  
  <ul>
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/" >
      💡 教程
  </a>


    

    




  
  <ul>
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/front-end-optimization-guide/" >
      前端优化指南
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/algorithm/" >
      算法
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/docs/tutorial/algorithm/backtracking/" >
      回溯法
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/tutorial/algorithm/array/" >
      数组
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/tutorial/algorithm/tree/" >
      树
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/tutorial/algorithm/string/" >
      字符串
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/tutorial/algorithm/dp/" >
      动态规划
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/tutorial/algorithm/linkedlist/"  class="active">
      链表
  </a>

</li>
      
    
  </ul>
  



  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/raft/" >
      raft
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/unix-command/" >
      UNIX 常用命令大全
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/unix-optimize/" >
      UNIX 性能优化
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/vue3/" >
      Vue.js 教程
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/git/" >
      Git 教程
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/network/" >
      网络协议
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/awk/" >
      AWK 教程
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/devops/" >
      DevOps
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/sentinel/" >
      阿里巴巴 Sentinel
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/zipkin/" >
      Zipkin 源码分析
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/eureka/" >
      Netflix Eureka 源码分析
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/distributed-storage/" >
      分布式存储
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/maven/" >
      Maven 教程
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/java/" >
      Java 教程
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/spring/" >
      Spring 教程
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/distributed/" >
      分布式系统与架构设计
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/softskill/" >
      箴言箴句
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/database/" >
      数据库
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/redis/" >
      Redis
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/bigdata/" >
      大数据场景
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tutorial/technique/" >
      技术
  </a>


    

    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/programmer-interview/" >
      👍 程序员面试题
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/rocketmq/" >
      RocketMQ 源码分析
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/books/" >
      书籍
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/javascript/" >
      JavaScript 专栏
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/it-zone/" >
      IT 圈
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/hire/" >
      招聘
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/cloud-plus-bbs/" >
      云&#43;社区技术沙龙
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/docs/tools/" >
      实用工具
  </a>


    

    






  </li>


      
    
  </ul>
  



  












<ul>
  
  <li>
    <a href="/posts/" >
        博客
      </a>
  </li>
  
</ul>



</nav>




  <script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>链表</strong>

  <label for="toc-control">
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#反转链表">反转链表</a></li>
    <li><a href="#反转链表-1">反转链表Ⅱ</a></li>
    <li><a href="#lru">LRU</a></li>
    <li><a href="#相交链表">相交链表</a></li>
    <li><a href="#k-个一组翻转链表">K 个一组翻转链表</a></li>
    <li><a href="#链表是否有环">链表是否有环</a></li>
    <li><a href="#链表找到环的入口节点">链表找到环的入口节点</a></li>
    <li><a href="#合并-k-个有序链表">合并 K 个有序链表</a></li>
    <li><a href="#删除链表的倒数第-n-个结点">删除链表的倒数第 N 个结点</a></li>
    <li><a href="#重排链表">重排链表</a></li>
    <li><a href="#删除排序链表中的重复元素-ii">删除排序链表中的重复元素 II</a></li>
    <li><a href="#排序链表">排序链表</a></li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
<article class="markdown">
  
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-8950855178079071"
data-ad-slot="6142361626"
data-ad-format="auto"
data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script><h1 id="链表">链表</h1>
<h2 id="反转链表">反转链表</h2>
<p>头条：<strong>迭代</strong>、<strong>递归</strong>都要写出来。</p>
<p><strong>迭代</strong>版本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">reverseList</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode newHead <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">();</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>head <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 5 -&gt; 4 -&gt; 3
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//
</span><span style="color:#75715e"></span>        ListNode tmp <span style="color:#f92672">=</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> newHead<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        newHead<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
        head <span style="color:#f92672">=</span> tmp<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> newHead<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><strong>递归</strong>版本。</p>
<blockquote>
<p>将链表想象为：<code>head -&gt; 其余部分</code>，那么翻转 <code>其余部分</code> 如何翻转：<code>p = reverseList(head.next)</code>。<code>其余部分</code> 的 <code>next</code> 的节点需要指向 <code>head</code>，<code>head</code> 的 <code>next</code> 节点需要置为 <code>null</code>，以确保 <code>head</code> 变成了末尾节点。最后返回 <code>p</code> 节点。</p>
</blockquote>
<ul>
<li>在写的时候，有一次写成了 <code>p.next = head</code>，这里是不正确的。<code>head.next.next = head; head.next = null</code> 这是真正干活的部分，是真正决策对于两个节点如何翻转的过程部分，其不属于递归。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">reverseList</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>head <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> head<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    ListNode p <span style="color:#f92672">=</span> reverseList<span style="color:#f92672">(</span>head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">);</span>
    head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
    head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="反转链表-1">反转链表Ⅱ</h2>
<p>美团面试题。</p>
<p>这道题，<a href="https://leetcode-cn.com/problems/reverse-linked-list-ii/solution/java-shuang-zhi-zhen-tou-cha-fa-by-mu-yi-cheng-zho/">这篇文章</a>的思路非常简洁易懂，其核心就是采用<strong>头插法</strong>，可以间接达到<strong>反转的效果</strong>。下面算法是看过他的思路之后，自己写出来的。</p>
<p>需要注意的地方，看下图 <code>removed</code> 的 <code>next</code> 节点应该调整为 <code>p</code>，即写作 <code>removed.next = p</code>：</p>
<pre><code>[pre] -&gt; [p] -&gt; [p.next] -&gt; [p.next.next]
                   ^
                   |
                 removed
</code></pre><p>第一次调整这样还可以，没有问题，但是第二次调整的时候，当前指针就变为了。这个时候一下就可以看出来 <code>removed.next</code> 就不能指向 <code>p</code> 了，而应该指向的永远都是 <code>pre.next</code>。<code>pre</code> 指针是不变的。</p>
<pre><code>[pre] -&gt; [p.next] -&gt; [p] -&gt; [p.next.next]
                                ^
                                |
                             removed
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">reverseBetween</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> left<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> right<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>left <span style="color:#f92672">==</span> right <span style="color:#f92672">||</span> head <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> head<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">// [] -&gt; [x] -&gt; [y] -&gt; [z]
</span><span style="color:#75715e"></span>    ListNode DUMMY <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">();</span>
    DUMMY<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>

    ListNode pre <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    ListNode p <span style="color:#f92672">=</span> DUMMY<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> left<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
        pre <span style="color:#f92672">=</span> p<span style="color:#f92672">;</span>
        p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> right <span style="color:#f92672">-</span> left<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// [pre] -&gt; [p] -&gt; [p.next] -&gt; [p.next.next]
</span><span style="color:#75715e"></span>        ListNode removed <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        ListNode removedNext <span style="color:#f92672">=</span> removed<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

        <span style="color:#75715e">// [pre] -&gt; [p] &lt;-&gt; [p.next]  [p.next.next]
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// 不能这样 removed.next = p;
</span><span style="color:#75715e"></span>        removed<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> pre<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">//   |--------------|
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//   |              v
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// [pre]  [p] &lt;-&gt; [p.next]  [p.next.next]
</span><span style="color:#75715e"></span>        pre<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> removed<span style="color:#f92672">;</span>
        <span style="color:#75715e">//   |--------------|
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//   |              v
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// [pre]  [p] &lt;- [p.next]  [p.next.next]
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//         |                     ^
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//         |_____________________|
</span><span style="color:#75715e"></span>        p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> removedNext<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> DUMMY<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="lru">LRU</h2>
<ul>
<li>底层数据结构是 <code>Map</code>，<code>key</code> 就是用户传入的 <code>key</code>，而 <code>value</code> 则是通过 <code>ListNode</code> 来封装起来。当前所有的 <code>&lt;key, value&gt;</code> 对通过<strong>双向链表</strong>来串起来，<code>head</code> 节点是最近一次刚刚访问过的，而 <code>tail</code> 是很长时间都没有访问过的。</li>
</ul>
<pre><code>[key1, value1]
[key2, value2]
...
[keyn, valuen]

[key1, value1] &lt;--&gt; [key2, value2] &lt;--&gt; ... [keyn, valuen]
</code></pre><p>所有的操作基本上核心的就是调整键值对在<strong>双向链表</strong>上的顺序。</p>
<ul>
<li>第一次 <code>put</code> 的时候，<code>insertAtHead</code></li>
<li>第二次 <code>put</code> 的时候，即 <code>updateValue</code> 的时候，<code>moveToHead</code> 做的操作，首先 <code>removeNode</code>，然后重新 <code>insertAtHead</code></li>
<li>为了保证 <code>remove</code> 的复杂度是 <code>O(1)</code>，我们需要将 <code>ListNode</code> 实现为<strong>双向链表</strong>。</li>
<li><code>get</code> 的时候，<code>moveToHead</code>。</li>
</ul>
<blockquote>
<p>通过借助 <code>DUMMY_HEAD</code> 和 <code>DUMMY_TAIL</code>，我们能够减轻处理特殊 case 编码的复杂度。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LRUCache</span> <span style="color:#f92672">{</span>
    
    <span style="color:#66d9ef">private</span> Map<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> ListNode<span style="color:#f92672">&gt;</span> cache <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">();</span>

    <span style="color:#75715e">// 先实现一个 remove() 复杂度是 O(1) 的双向链表
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// head 是 rencently 的，tail 是即将淘汰的
</span><span style="color:#75715e"></span>    
    ListNode DUMMY_HEAD <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">(-</span>1<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">);</span>
    ListNode DUMMY_TAIL <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">(-</span>1<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">);</span>
    
    <span style="color:#f92672">{</span>
        DUMMY_HEAD<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> DUMMY_TAIL<span style="color:#f92672">;</span>
        DUMMY_TAIL<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> DUMMY_HEAD<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> capacity<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">LRUCache</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> capacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">capacity</span> <span style="color:#f92672">=</span> capacity<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> key<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        ListNode node <span style="color:#f92672">=</span> cache<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>key<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>node <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        
        moveToHead<span style="color:#f92672">(</span>node<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> node<span style="color:#f92672">.</span><span style="color:#a6e22e">value</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> key<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> value<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        ListNode node <span style="color:#f92672">=</span> cache<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>key<span style="color:#f92672">);</span>
        
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>node <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>cache<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">()</span> <span style="color:#f92672">==</span> capacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                ListNode tailNode <span style="color:#f92672">=</span> DUMMY_TAIL<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span><span style="color:#f92672">;</span>
                removeNode<span style="color:#f92672">(</span>tailNode<span style="color:#f92672">);</span>
                cache<span style="color:#f92672">.</span><span style="color:#a6e22e">remove</span><span style="color:#f92672">(</span>tailNode<span style="color:#f92672">.</span><span style="color:#a6e22e">key</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
            
            node <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">(</span>key<span style="color:#f92672">,</span> value<span style="color:#f92672">);</span>
            insertAtHead<span style="color:#f92672">(</span>node<span style="color:#f92672">);</span>
            cache<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span>key<span style="color:#f92672">,</span> node<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            node<span style="color:#f92672">.</span><span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> value<span style="color:#f92672">;</span>
            moveToHead<span style="color:#f92672">(</span>node<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">moveToHead</span><span style="color:#f92672">(</span>ListNode p<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        removeNode<span style="color:#f92672">(</span>p<span style="color:#f92672">);</span>
        insertAtHead<span style="color:#f92672">(</span>p<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
    
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">removeNode</span><span style="color:#f92672">(</span>ListNode p<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span><span style="color:#f92672">;</span>
        p<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">insertAtHead</span><span style="color:#f92672">(</span>ListNode p<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        ListNode next <span style="color:#f92672">=</span> DUMMY_HEAD<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        
        p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> next<span style="color:#f92672">;</span>
        next<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">;</span>
        
        DUMMY_HEAD<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">;</span>
        p<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> DUMMY_HEAD<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ListNode</span> <span style="color:#f92672">{</span>
        
        <span style="color:#66d9ef">int</span> key<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> value<span style="color:#f92672">;</span>
        ListNode prev<span style="color:#f92672">;</span>
        ListNode next<span style="color:#f92672">;</span>
        
        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">ListNode</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> key<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> value<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> key<span style="color:#f92672">;</span>
            <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> value<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        
    <span style="color:#f92672">}</span>
    
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="相交链表">相交链表</h2>
<p>找到两个链表的第一个交集的这个 <code>ListNode</code>。</p>
<ul>
<li><strong>长</strong>的先走 <code>diff</code> 个 <code>ListNode</code></li>
<li>然后一起走，遇到的第一个相同的 <code>ListNode</code> 就是结果</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">getIntersectionNode</span><span style="color:#f92672">(</span>ListNode headA<span style="color:#f92672">,</span> ListNode headB<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>   
    <span style="color:#66d9ef">int</span> lenA <span style="color:#f92672">=</span> len<span style="color:#f92672">(</span>headA<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">int</span> lenB <span style="color:#f92672">=</span> len<span style="color:#f92672">(</span>headB<span style="color:#f92672">);</span>

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>lenA <span style="color:#f92672">&lt;</span> lenB<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> getIntersectionNode<span style="color:#f92672">(</span>headB<span style="color:#f92672">,</span> headA<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    ListNode pA <span style="color:#f92672">=</span> headA<span style="color:#f92672">;</span>
    ListNode pB <span style="color:#f92672">=</span> headB<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">int</span> diff <span style="color:#f92672">=</span> lenA <span style="color:#f92672">-</span> lenB<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>diff <span style="color:#f92672">&gt;</span> 0 <span style="color:#f92672">&amp;&amp;</span> pA <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        pA <span style="color:#f92672">=</span> pA<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        diff<span style="color:#f92672">--;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>pA <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> pB <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>pA <span style="color:#f92672">==</span> pB<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> pA<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        pA <span style="color:#f92672">=</span> pA<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        pB <span style="color:#f92672">=</span> pB<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">len</span><span style="color:#f92672">(</span>ListNode root<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
    ListNode p <span style="color:#f92672">=</span> root<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>p <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        count<span style="color:#f92672">++;</span>
        p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> count<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="k-个一组翻转链表">K 个一组翻转链表</h2>
<ul>
<li>找到第 <code>kth</code> 个节点</li>
<li>翻转 <code>head</code> 到 <code>kth</code> 之间的节点</li>
<li><code>kth.next</code> 就是新的 <code>newHead</code>，递归翻转 <code>reverseKGroup(newHead)</code></li>
<li>上次翻转完的 <code>head</code> 变成了尾巴，这个 <code>head</code> 的 <code>next</code> 要指向新的 <code>reverseKGroup</code> 返回的节点</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">reverseKGroup</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> k<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode kth <span style="color:#f92672">=</span> findKth<span style="color:#f92672">(</span>head<span style="color:#f92672">,</span> k<span style="color:#f92672">);</span>
    
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>kth <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        ListNode newHead <span style="color:#f92672">=</span> kth<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

        reverse<span style="color:#f92672">(</span>head<span style="color:#f92672">,</span> kth<span style="color:#f92672">);</span>
        head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> reverseKGroup<span style="color:#f92672">(</span>newHead<span style="color:#f92672">,</span> k<span style="color:#f92672">);</span>

        <span style="color:#66d9ef">return</span> kth<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> head<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">// 1,2,3,4,5 k = 3，
</span><span style="color:#75715e">// 那么 最终返回的 Node 指向 3
</span><span style="color:#75715e">// 如果不够，比如 k = 100，那么返回 null
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> ListNode <span style="color:#a6e22e">findKth</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> k<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span>
    ListNode p <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>count <span style="color:#f92672">&lt;</span> k <span style="color:#f92672">&amp;&amp;</span> p <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        count<span style="color:#f92672">++;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> count <span style="color:#f92672">==</span> k <span style="color:#f92672">?</span> p <span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">// 1,2,3 =&gt; 3,2,1
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">reverse</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">,</span> ListNode end<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode newHead <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    ListNode p <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>p <span style="color:#f92672">!=</span> end<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        ListNode next <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        
        p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> newHead<span style="color:#f92672">;</span>
        newHead <span style="color:#f92672">=</span> p<span style="color:#f92672">;</span>

        p <span style="color:#f92672">=</span> next<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    end<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> newHead<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="链表是否有环">链表是否有环</h2>
<blockquote>
<p>设置 <code>faster</code> 和 <code>slower</code> 指针，<strong>相遇</strong>即可证明有环。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">hasCycle</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>head <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    ListNode slower <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
    ListNode faster <span style="color:#f92672">=</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>slower <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> faster <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>slower <span style="color:#f92672">==</span> faster<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        slower <span style="color:#f92672">=</span> slower<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        faster <span style="color:#f92672">=</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="链表找到环的入口节点">链表找到环的入口节点</h2>
<ul>
<li>快慢指针找到相遇节点 <code>meetNode</code></li>
<li>根据 <code>meetNode</code> 探测环的长度 <code>cycleLen</code></li>
<li><code>faster</code> 指针先移动 <code>cycleLen</code> 个</li>
<li><code>faster</code> 和 <code>slower</code> 一起移动，直到相遇</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#75715e">// 1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 1 -&gt; 2 -&gt; 3
</span><span style="color:#75715e">//                     ↑_________|
</span><span style="color:#75715e">//
</span><span style="color:#75715e">// 假设链表长度为 L = 4
</span><span style="color:#75715e">// 假设环长度为 C = 3
</span><span style="color:#75715e">// 假设相遇时的点，距离环的入口 [逆时针顺序] 长度为 K
</span><span style="color:#75715e">//
</span><span style="color:#75715e">// 最终相遇:
</span><span style="color:#75715e">// - 快指针走了 L + m * C + K 步骤
</span><span style="color:#75715e">// - 慢指针走了 L + n * C + K 步骤
</span><span style="color:#75715e">//
</span><span style="color:#75715e">// L + m * C + K = 2 * (L + n * C + K)
</span><span style="color:#75715e">//
</span><span style="color:#75715e">// 化简得到 m * C = L + 2n * C + K
</span><span style="color:#75715e">// 化简得到 (m - 2n) * C = L + K
</span><span style="color:#75715e">// 化简得到 K = (m - 2n) * C - L = n&#39; * C - L
</span><span style="color:#75715e">//
</span><span style="color:#75715e">// 即 K 是常数
</span><span style="color:#75715e">//
</span><span style="color:#75715e">// 此时，相遇点 K 的位置是 n&#39; * C - L，它再走 L 步就能到链表入口处
</span><span style="color:#75715e">// 而此时慢指针从头开始走，也需要 L 步才能到链表入口处，所以这个是可以找到入口的
</span><span style="color:#75715e">//
</span><span style="color:#75715e">// 还有就是如下这个代码，faster 从头开始移动 C 个，因为总长度是 L + C 个，所以全程还剩余 L 个
</span><span style="color:#75715e">// 慢指针也需要走 L 步，所以还是会相遇
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LinkedListCycle2</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">detectCycle</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// 是否有环
</span><span style="color:#75715e"></span>        ListNode meetNode <span style="color:#f92672">=</span> hasCycle<span style="color:#f92672">(</span>head<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>meetNode <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">// 求出环的个数
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> cycleLen <span style="color:#f92672">=</span> lengthOfCycle<span style="color:#f92672">(</span>meetNode<span style="color:#f92672">);</span>

        <span style="color:#75715e">// 先移动 cycleLen 个
</span><span style="color:#75715e"></span>        ListNode faster <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>cycleLen <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            faster <span style="color:#f92672">=</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
            cycleLen<span style="color:#f92672">--;</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">// 一起移动
</span><span style="color:#75715e"></span>        ListNode slower <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>faster <span style="color:#f92672">!=</span> slower<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            faster <span style="color:#f92672">=</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
            slower <span style="color:#f92672">=</span> slower<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        <span style="color:#66d9ef">return</span> slower<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">lengthOfCycle</span><span style="color:#f92672">(</span>ListNode meetNode<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        ListNode p <span style="color:#f92672">=</span> meetNode<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> c <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span>

        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>p <span style="color:#f92672">!=</span> meetNode<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
            c<span style="color:#f92672">++;</span>
        <span style="color:#f92672">}</span>

        <span style="color:#66d9ef">return</span> c<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">hasCycle</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>head <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        ListNode slower <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
        ListNode faster <span style="color:#f92672">=</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>slower <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> faster <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>slower <span style="color:#f92672">==</span> faster<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> slower<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

            slower <span style="color:#f92672">=</span> slower<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

            faster <span style="color:#f92672">=</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><h2 id="合并-k-个有序链表">合并 K 个有序链表</h2>
<p>借助优先队列 <code>PriorityQueue</code> 即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">mergeKLists</span><span style="color:#f92672">(</span>List<span style="color:#f92672">&lt;</span>ListNode<span style="color:#f92672">&gt;</span> lists<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode DUMMY <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">(-</span>1<span style="color:#f92672">);</span>
    ListNode p <span style="color:#f92672">=</span> DUMMY<span style="color:#f92672">;</span>

    PriorityQueue<span style="color:#f92672">&lt;</span>ListNode<span style="color:#f92672">&gt;</span> queue <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PriorityQueue<span style="color:#f92672">&lt;&gt;(</span><span style="color:#66d9ef">new</span> Comparator<span style="color:#f92672">&lt;</span>ListNode<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>

        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span><span style="color:#f92672">(</span>ListNode n1<span style="color:#f92672">,</span> ListNode n2<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>n1<span style="color:#f92672">.</span><span style="color:#a6e22e">val</span> <span style="color:#f92672">&lt;</span> n2<span style="color:#f92672">.</span><span style="color:#a6e22e">val</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>n2<span style="color:#f92672">.</span><span style="color:#a6e22e">val</span> <span style="color:#f92672">&lt;</span> n1<span style="color:#f92672">.</span><span style="color:#a6e22e">val</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> 1<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> 0<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>

    <span style="color:#f92672">});</span>

    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>ListNode node<span style="color:#f92672">:</span> lists<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>node <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            queue<span style="color:#f92672">.</span><span style="color:#a6e22e">offer</span><span style="color:#f92672">(</span>node<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(!</span>queue<span style="color:#f92672">.</span><span style="color:#a6e22e">isEmpty</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
        ListNode curr <span style="color:#f92672">=</span> queue<span style="color:#f92672">.</span><span style="color:#a6e22e">poll</span><span style="color:#f92672">();</span>

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>curr<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            queue<span style="color:#f92672">.</span><span style="color:#a6e22e">offer</span><span style="color:#f92672">(</span>curr<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>

        p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> curr<span style="color:#f92672">;</span>
        p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> DUMMY<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="删除链表的倒数第-n-个结点">删除链表的倒数第 N 个结点</h2>
<p>要求是一遍扫描。只用一个指针不行，所以得上两个指针。<a href="https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list/solution/dong-hua-tu-jie-leetcode-di-19-hao-wen-ti-shan-chu/">思路</a></p>
<ul>
<li>设置虚拟节点 <code>dummyHead</code> 指向 <code>head</code></li>
<li>设定双指针 <code>p</code> 和 <code>q</code>，初始都指向虚拟节点 <code>dummyHead</code></li>
<li>移动 <code>q</code>，直到 <code>p</code> 与 <code>q</code> 之间相隔的元素个数为 <code>n</code></li>
<li>同时移动 <code>p</code> 与 <code>q</code>，直到 <code>q</code> 指向的为 <code>NULL</code></li>
<li>将 <code>p</code> 的下一个节点指向下下个节点</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">removeNthFromEnd</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> n<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode DUMMY <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">();</span>
    DUMMY<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>

    ListNode slower <span style="color:#f92672">=</span> DUMMY<span style="color:#f92672">;</span>
    ListNode faster <span style="color:#f92672">=</span> DUMMY<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> n<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
        faster <span style="color:#f92672">=</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>faster <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        slower <span style="color:#f92672">=</span> slower<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        faster <span style="color:#f92672">=</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    slower<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> slower<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

    <span style="color:#66d9ef">return</span> DUMMY<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="重排链表">重排链表</h2>
<p>寻找链表中点 + 链表右半段逆序 + 合并链表</p>
<p>注意寻找链表<strong>中点</strong>的写法：<code>while (faster.next != null &amp;&amp; faster.next.next != null) { ... }</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">reorderList</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode middle <span style="color:#f92672">=</span> findMiddle<span style="color:#f92672">(</span>head<span style="color:#f92672">);</span>

    ListNode rightHalfHead <span style="color:#f92672">=</span> middle<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    middle<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>

    ListNode reversedRightHalfHead <span style="color:#f92672">=</span> reverse<span style="color:#f92672">(</span>rightHalfHead<span style="color:#f92672">);</span>
    mergeListNode<span style="color:#f92672">(</span>head<span style="color:#f92672">,</span> reversedRightHalfHead<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">// 1 -&gt; [2] -&gt; 3 -&gt; 4, 返回 2
</span><span style="color:#75715e">// 1 -&gt; 2 -&gt; [3] -&gt; 4 -&gt; 5, 返回 3
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> ListNode <span style="color:#a6e22e">findMiddle</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode slower <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
    ListNode faster <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>

    <span style="color:#75715e">// 这样写
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        slower <span style="color:#f92672">=</span> slower<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        faster <span style="color:#f92672">=</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> slower<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> ListNode <span style="color:#a6e22e">reverse</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>head <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> head<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    ListNode p <span style="color:#f92672">=</span> reverse<span style="color:#f92672">(</span>head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">);</span>
    head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
    head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mergeListNode</span><span style="color:#f92672">(</span>ListNode headA<span style="color:#f92672">,</span> ListNode headB<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// merge headB -&gt; headA
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// 1 -&gt; 2 -&gt; 3
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// 5 -&gt; 4
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>headA <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> headB <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        ListNode nextA <span style="color:#f92672">=</span> headA<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        ListNode nextB <span style="color:#f92672">=</span> headB<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

        headA<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> headB<span style="color:#f92672">;</span>
        headB<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> nextA<span style="color:#f92672">;</span>

        headA <span style="color:#f92672">=</span> nextA<span style="color:#f92672">;</span>
        headB <span style="color:#f92672">=</span> nextB<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="删除排序链表中的重复元素-ii">删除排序链表中的重复元素 II</h2>
<p>下面算法虽然正确，但是并没有考虑其降序/升序的性质。</p>
<ul>
<li>当重复元素，下一个元素开始不重复的时候，<code>prev</code> 指针不需要移动，如下图所示。只需要调整 <code>prev.next = p.next</code> 即可</li>
</ul>
<pre><code>  1 -&gt; 2 -&gt; 2 -&gt; 2 -&gt; 3
prev             p  
</code></pre><ul>
<li>当无重复元素，那么 <code>prev</code> 跟着后移即可</li>
</ul>
<pre><code>1 -&gt; 2 -&gt; 3 -&gt; 4
    prev p [一起后移即可]
         prev  p
</code></pre><ul>
<li>我们需要用 <code>hasDuplicated</code> 变量来标识当前 <code>prev</code> 应不应该移动</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">deleteDuplicates</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode DUMMY <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">();</span>
    DUMMY<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>

    ListNode prev <span style="color:#f92672">=</span> DUMMY<span style="color:#f92672">;</span>
    ListNode p <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">boolean</span> hasDuplicated <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>

    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>p <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">val</span> <span style="color:#f92672">==</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">val</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
                hasDuplicated <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
                <span style="color:#75715e">// prev -&gt; 重复 -&gt; 重复 -&gt; 不重复
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//                 p
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>hasDuplicated<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    prev<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
                    hasDuplicated <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
                    prev <span style="color:#f92672">=</span> p<span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>

                p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>hasDuplicated<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                prev<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
                prev<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

            <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> DUMMY<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="排序链表">排序链表</h2>
<p>题目要求空间复杂度是 <code>O(1)</code>，因此<strong>不能使用递归</strong>。应该使用 <code>bottom-to-top</code> 版本的归并排序：</p>
<p>TODO</p>
<p><strong>归并排序</strong>，如下使用递归版本的实际上空间复杂度并不是 <code>O(1)</code>：</p>
<ol>
<li>找到链表中点</li>
<li>左半段递归，中点的 <code>next</code> 置为 <code>null</code>，右半段递归</li>
<li>左半段、右半段归并</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">sortList</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">return</span> mergeSort<span style="color:#f92672">(</span>head<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">// 归并排序
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> ListNode <span style="color:#a6e22e">mergeSort</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">){</span>
    <span style="color:#75715e">// 如果没有结点/只有一个结点，无需排序，直接返回
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>head <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> head<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">// 快慢指针找出中位点
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// 1 -&gt; 2 -&gt; 3
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// f
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// p
</span><span style="color:#75715e"></span>    ListNode middle <span style="color:#f92672">=</span> findMiddle<span style="color:#f92672">(</span>head<span style="color:#f92672">);</span>

    <span style="color:#75715e">// 节点断掉
</span><span style="color:#75715e"></span>    ListNode middleNext <span style="color:#f92672">=</span> middle<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    middle<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>

    <span style="color:#75715e">// 对左半部分进行归并排序
</span><span style="color:#75715e"></span>    ListNode l <span style="color:#f92672">=</span> mergeSort<span style="color:#f92672">(</span>head<span style="color:#f92672">);</span>

    <span style="color:#75715e">// 对右半部分进行归并排序
</span><span style="color:#75715e"></span>    ListNode r <span style="color:#f92672">=</span> mergeSort<span style="color:#f92672">(</span>middleNext<span style="color:#f92672">);</span>

    <span style="color:#66d9ef">return</span> mergeList<span style="color:#f92672">(</span>l<span style="color:#f92672">,</span> r<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">// 1 -&gt; [2] -&gt; 3 -&gt; 4, 返回 2
</span><span style="color:#75715e">// 1 -&gt; 2 -&gt; [3] -&gt; 4 -&gt; 5, 返回 3
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> ListNode <span style="color:#a6e22e">findMiddle</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    ListNode slower <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>
    ListNode faster <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>

    <span style="color:#75715e">// 这样写
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        slower <span style="color:#f92672">=</span> slower<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        faster <span style="color:#f92672">=</span> faster<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">return</span> slower<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">// 合并链表
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> ListNode <span style="color:#a6e22e">mergeList</span><span style="color:#f92672">(</span>ListNode l<span style="color:#f92672">,</span>ListNode r<span style="color:#f92672">){</span>
    <span style="color:#75715e">// 临时头节点
</span><span style="color:#75715e"></span>    ListNode tmpHead <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">(-</span>1<span style="color:#f92672">);</span>
    ListNode p <span style="color:#f92672">=</span> tmpHead<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>l <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> r <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">){</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>l<span style="color:#f92672">.</span><span style="color:#a6e22e">val</span> <span style="color:#f92672">&lt;</span> r<span style="color:#f92672">.</span><span style="color:#a6e22e">val</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> l<span style="color:#f92672">;</span>
            l <span style="color:#f92672">=</span> l<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> r<span style="color:#f92672">;</span>
            r <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        
        p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>l <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">?</span> r <span style="color:#f92672">:</span> l<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">return</span> tmpHead<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><strong>快速排序</strong>版本，面试官可能会问。快速排序的整体思路：</p>
<ol>
<li>将一段链表 <code>[head] -&gt; ... -&gt; [end]</code> 先进行 <code>partition</code>。<code>pivot</code> 选择 <code>[1] -&gt; [2] -&gt; [3] -&gt; [4]</code>，那么 <code>pivot</code> 就是 <code>head.next = [2]</code>。</li>
<li><code>quickSort(left)</code></li>
<li><code>quickSort(right)</code></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#66d9ef">public</span> ListNode <span style="color:#a6e22e">sortList</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>head <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> 
        <span style="color:#66d9ef">return</span> head<span style="color:#f92672">;</span>
    
    <span style="color:#75715e">// 没有条件，创造条件。自己添加头节点，最后返回时去掉即可。
</span><span style="color:#75715e"></span>    ListNode newHead <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">(-</span>1<span style="color:#f92672">);</span>
    newHead<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> head<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">return</span> quickSort<span style="color:#f92672">(</span>newHead<span style="color:#f92672">,</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">// 带头结点的链表快速排序
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> ListNode <span style="color:#a6e22e">quickSort</span><span style="color:#f92672">(</span>ListNode head<span style="color:#f92672">,</span> ListNode end<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// head.next.next == end 1 -&gt; 2 -&gt; 1
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>head <span style="color:#f92672">==</span> end <span style="color:#f92672">||</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> end <span style="color:#f92672">||</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">==</span> end<span style="color:#f92672">)</span> 
        <span style="color:#66d9ef">return</span> head<span style="color:#f92672">;</span>

    <span style="color:#75715e">// 将小于划分点的值存储在临时链表中
</span><span style="color:#75715e"></span>    ListNode tmpHead <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ListNode<span style="color:#f92672">(-</span>1<span style="color:#f92672">);</span>
    <span style="color:#75715e">// partition为划分点，p为链表指针，tp为临时链表指针
</span><span style="color:#75715e"></span>    ListNode partition <span style="color:#f92672">=</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">,</span> p <span style="color:#f92672">=</span> partition<span style="color:#f92672">,</span> tp <span style="color:#f92672">=</span> tmpHead<span style="color:#f92672">;</span>
    
    <span style="color:#75715e">// 将小于划分点的结点放到临时链表中
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">!=</span> end<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">val</span> <span style="color:#f92672">&lt;</span> partition<span style="color:#f92672">.</span><span style="color:#a6e22e">val</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            tp<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
            tp <span style="color:#f92672">=</span> tp<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>

            p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            p <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">// 合并临时链表和原链表，将原链表接到临时链表后面即可
</span><span style="color:#75715e"></span>    tp<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    
    <span style="color:#75715e">// 将临时链表插回原链表，注意是插回！（不做这一步在对右半部分处理时就断链了）
</span><span style="color:#75715e"></span>    head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> tmpHead<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    
    quickSort<span style="color:#f92672">(</span>head<span style="color:#f92672">,</span> partition<span style="color:#f92672">);</span>
    quickSort<span style="color:#f92672">(</span>partition<span style="color:#f92672">,</span> end<span style="color:#f92672">);</span>

    <span style="color:#75715e">// 题目要求不带头节点，返回结果时去除
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> head<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div>
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-8950855178079071"
data-ad-slot="6142361626"
data-ad-format="auto"
data-full-width-responsive="true"></ins>
</article>
 

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
  
  <div class="book-comments">  </div>
  
 
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#反转链表">反转链表</a></li>
    <li><a href="#反转链表-1">反转链表Ⅱ</a></li>
    <li><a href="#lru">LRU</a></li>
    <li><a href="#相交链表">相交链表</a></li>
    <li><a href="#k-个一组翻转链表">K 个一组翻转链表</a></li>
    <li><a href="#链表是否有环">链表是否有环</a></li>
    <li><a href="#链表找到环的入口节点">链表找到环的入口节点</a></li>
    <li><a href="#合并-k-个有序链表">合并 K 个有序链表</a></li>
    <li><a href="#删除链表的倒数第-n-个结点">删除链表的倒数第 N 个结点</a></li>
    <li><a href="#重排链表">重排链表</a></li>
    <li><a href="#删除排序链表中的重复元素-ii">删除排序链表中的重复元素 II</a></li>
    <li><a href="#排序链表">排序链表</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</body>



</html>












